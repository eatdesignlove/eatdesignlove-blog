---
emoji: "✏️"
title: "캔버스 프로토타이핑, 그리고 수학"
subtitle: "좌표간 거리 구하기와 45도의 선들을 빈틈없이 배치하기"
date: "2019-12-23"
category: "Devlopment"
---

### 캔버스 프로토타이핑
최근 HTML5 캔버스(Canvas)를 사용하여 그래픽을 표현해야할 일이 있었다. (~~사실 일을 만들었다~~) 브랜드팀에서 넘겨받은 디자인을 보면서 동료 디자이너분과 대화를 나누던 중 디자인에 모션감이 더해지면 좋지 않을까란 얘기를 하고선 곧 프로토타이핑을 시작했다. 어쩌면 Affter Effect로 영상을 만들고 배경으로 넣어주는 것이 더 수월한 방법이었지만, 전부터 관심가지고 있던 캔버스를 이용하여 (~~공부해서~~) 구현해보기로 했다.

### 내가 수학이라니
막상 애니메이션을 구현하려고하니 그래픽 요소의 배치나 제어에 어려움이 있었는데, 캔버스 내 좌표를 기반으로 그래픽 요소들을 표현하고 움직여야하다보니 디버깅은 물론이고 원하는대로 화면에 표현하는 것조차 그리 간단하지 않았다. 특히 만들어낸 요소 사이의 거리를 알아야 하는 경우들이 있었는데, 이를 해결하기 위해선 수학이 필요했다.

지독한 수포자였던 내게 피타고라스의 정리와 같은 단어들은 고등학교 시절 추억을 회상할 때나 떠올리는 추억거리 정도로만 남을 줄 알았지, 지금와서 다시 마주할 일이 생길거라곤 상상도 못했다. 하지만 학창시절 왜 배워야하는지 전혀 동기부여되지 않던 내용들이었음에도 작업을 통해 배워야할 이유를 갖게 되자 완전히 새롭고 흥미롭게 느껴졌다. 간단한 내용이긴하지만 기록과 공유에 의미가 있을 것 같아 간략하게나마 정리해 보았다.

### 두 좌표 사이의 거리 구하기
구현하려는 그래픽의 핵심은 선의 움직임이었다. 각 선의 길이는 최대값을 가지는데, 그 최대값까지 늘어났다 줄어들었다를 반복하며 나아간다. 이때 시작점과 끝점 간의 거리를 알아야만 최대 길이와의 비교가 가능하다. 때문에 선의 시작점과 끝점 사이의 거리를 알아야할 필요가 있었다.

```javascript
ctx.beginPath(); *// 패스의 시작을 선언*
ctx.moveTo(x1, y1); *// 선의 시작점*
ctx.lineTo(x2, y2); *// 선의 끝점*
ctx.stroke(); *// 선 그리기*
```

캔버스에서 선을 그리는 방법은 위와 같다. `moveTo`의 인자로 시작점의 x, y 값을, `lineTo`의 인자로 끝점의 x, y값을 넣어주고, stroke 메서드를 실행하면 그릴 수 있다.

이때 두 점의 거리는 어떻게 구할 수 있을까? 두 점을 기준으로 직각삼각형을 그려보자. 피타고라스의 정리에 따라 빗변의 제곱은 나머지 두 변의 길이의 제곱의 합과 같다.

빗변의 제곱은 제곱근 나머지 두 변의 길이의 제곱의 합과 같으므로 자바스크립트에서 제곱근을 구해주는 Math.sqrt를 이용하여 아래와 같이 계산해볼 수 있다.

```
const dx = x2 - x1;
const dy = y2 - y1;
const distance = Math.sqrt(dx * dx + dy * dy);
```

### 45도의 선들을 빈틈없이 배치하기

화면 안에 일정한 간격으로 선을 배치했는데, 45도로 진행하는 선들이 겹쳐지지 않도록 배치하여야 했다. 그러자면 선의 두깨와 기울기에 맞게 시작점들 간의 적절한 거리를 계산이 필요했다.

선의 중심을 기준으로 두깨를 r이라고할때, 45도와 90도로 구성된 이등변삼각형을 그려볼 수 있다. 동일하게 피타고라스의 정리를 대입해보면 한 변의 길이가 r인 이등변삼각형의 빗변은 제곱근 2 곱하기 r과 같다. 그리고 그 값을 2로 곱한 값이 바로 다음선이 출발하는 기준점의 좌표가 되는 것이다.

```
const distance = Math.sqrt(2) * r;
```

### 두려움을 넘어서
사실 결과물만 놓고보면 구현하기에 별로 복잡한 내용은 없다. 언급했던 수학 역시 어려운 공식이 필요한 것도 아니다. 하지만 언제나 그렇듯 새로운 것을 시도한다는 점, 그리고 그것이 실패할 수도 있다는 점은 왠지모를 두려움을 갖게 한다.

그런 측면에서 프로토타이핑은 두려움을 떨쳐내는데 도움을 주는 좋은 도구가 됨을 체감했다. 사실 최초 디자인과 결과물 사이에는 차이가 있었지만 미팅때 프로토타입을 공유하니 걱정과 달리 다들 좋아해주셨고, 덕분에 실제 서비스에 적용해볼 수 있는 기회도 얻을 수 있었기 때문이다.

프로토타이핑의 핵심은 속도. 캔버스를 이용한 다양한 프로토타입을 빠르게 만들 수 있으려면 캔버스 상에서 요소를 표현할 때 요긴하게 쓸 수 있는 지식(위와 같은 수학 공식이라던지)를 몇 가지 숙지하고 있다면 훨씬 더 만족할 만한 결과를 빠르게 얻을 수 있을 것 같다.

### 참고자료
[Canvas API](https://developer.mozilla.org/ko/docs/Web/HTML/Canvas)
[피타고라스의 정리, 증명](https://mathbang.net/130)
[대각선의 길이 구하는 공식 - 피타고라스의 정리 활용](https://mathbang.net/135)